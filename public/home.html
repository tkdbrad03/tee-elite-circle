<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="/images/tee-elite-favicon.png">
  <title>Invitational Hub — Tee Elite Circle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#163326">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Tee Elite">
  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400;1,500&family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="pwa-nav.css">
  <style>
    /* ── STICKY PROGRESS ── */
    .sticky-progress{
      position:sticky;top:66px;z-index:100;
      background:rgba(255,255,255,.92);backdrop-filter:blur(8px);
      border-bottom:1px solid var(--line);
      padding:10px 24px;display:flex;align-items:center;gap:14px;
      margin:0 -24px 28px;
    }
    .sp-bar-bg{flex:1;height:4px;background:var(--tmac-blush-light);border-radius:2px}
    .sp-bar{height:4px;border-radius:2px;background:linear-gradient(90deg,var(--gold),var(--gold2));transition:width .5s ease;width:0%}
    .sp-label{font-size:11px;color:var(--muted);white-space:nowrap;letter-spacing:.05em}
    :root{
      --green:#163326;--green2:#1E3A2B;--gold:#A87C28;--gold2:#C9A24A;
      --gold-lt:#EDD9A3;--white:#FFFFFF;--off:#F8F7F4;--ink:#163326;
      --body:#2C2C2C;--muted:#555555;--line:rgba(0,0,0,.12);
      --serif:"Cormorant Garamond",Georgia,serif;
      --sans:"Jost",ui-sans-serif,system-ui,sans-serif;
      /* legacy aliases so existing classes still resolve */
      --tmac-bronze:#A87C28;--tmac-gold:#C9A24A;--tmac-blush:#e8ccc8;
      --tmac-blush-light:#f7f0ef;--deep-forest:#163326;--charcoal:#2C2C2C;
    }
    *,*::before,*::after{box-sizing:border-box}
    body{font-family:var(--sans);background:var(--white);color:var(--body);-webkit-font-smoothing:antialiased;}
    .hub-container{max-width:860px;margin:0 auto;padding:32px 24px 100px}
    .welcome-strip{display:flex;align-items:center;justify-content:space-between;margin-bottom:32px}
    .welcome-label{font-size:11px;letter-spacing:.22em;text-transform:uppercase;color:var(--tmac-bronze);margin-bottom:4px}
    .welcome-name{font-family:var(--serif);font-size:clamp(26px,4vw,34px);font-weight:400;color:var(--charcoal);line-height:1.1}
    .member-badge{background:var(--green);color:var(--tmac-blush);font-size:10px;letter-spacing:.18em;text-transform:uppercase;padding:6px 16px;border-radius:999px;display:inline-flex;align-items:center;gap:6px}
    .member-badge::before{content:''}
    .countdown-banner{background:var(--green);border-radius:20px;padding:28px 32px;margin-bottom:28px;position:relative;overflow:hidden}
    .countdown-banner::before{content:'';position:absolute;top:0;right:0;bottom:0;width:4px;background:linear-gradient(180deg,var(--tmac-gold),var(--tmac-blush))}
    .countdown-inner{display:flex;align-items:center;justify-content:space-between;gap:24px}
    .countdown-eyebrow{font-size:10px;letter-spacing:.22em;text-transform:uppercase;color:var(--tmac-gold);margin-bottom:6px}
    .countdown-title{font-family:var(--serif);font-size:22px;color:#fff;margin-bottom:2px}
    .countdown-date-str{font-size:12px;color:rgba(255,255,255,.5)}
    .countdown-digits{display:flex;gap:20px;flex-shrink:0}
    .cd-unit{text-align:center;min-width:44px}
    .cd-num{font-family:var(--serif);font-size:42px;color:var(--tmac-blush);line-height:1;display:block}
    .cd-label{font-size:9px;letter-spacing:.15em;text-transform:uppercase;color:rgba(255,255,255,.4);margin-top:4px}
    .section-head{display:flex;align-items:baseline;justify-content:space-between;margin-bottom:16px}
    .section-label{font-size:10px;letter-spacing:.22em;text-transform:uppercase;color:var(--tmac-bronze)}
    .section-link{font-size:11px;color:var(--tmac-bronze);text-decoration:none;letter-spacing:.05em}
    .section-link:hover{text-decoration:underline}
    .team-card{background:var(--white);border:1px solid var(--line);border-radius:20px;padding:28px;margin-bottom:28px}
    .team-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}
    .team-tag{font-size:10px;letter-spacing:.18em;text-transform:uppercase;color:var(--tmac-bronze);margin-bottom:4px}
    .team-name{font-family:var(--serif);font-size:22px;color:var(--charcoal)}
    .team-ready-pill{font-size:10px;letter-spacing:.12em;text-transform:uppercase;padding:5px 12px;border-radius:20px;font-weight:500}
    .pill-good{background:#edf7ed;color:#2e7d32}.pill-warn{background:#fff8e1;color:#a67c00}.pill-alert{background:#fdecea;color:#c62828}
    .team-members-list{display:flex;flex-direction:column;gap:12px}
    .team-member-row{display:flex;align-items:center;gap:14px;padding:12px 0;border-bottom:1px solid rgba(0,0,0,.05)}
    .team-member-row:last-child{border-bottom:none}
    .tm-avatar{width:40px;height:40px;border-radius:50%;background:var(--tmac-blush);display:flex;align-items:center;justify-content:center;font-size:14px;color:var(--deep-forest);flex-shrink:0;overflow:hidden}
    .tm-info{flex:1}
    .tm-name{font-size:14px;font-weight:500;color:var(--charcoal)}
    .tm-hcp{font-size:12px;color:#888;margin-top:1px}
    .tm-status{display:flex;flex-direction:column;align-items:flex-end;gap:4px}
    .status-dot{width:8px;height:8px;border-radius:50%;display:inline-block;margin-right:5px}
    .dot-green{background:#4caf50}.dot-yellow{background:#ffc107}.dot-red{background:#f44336}
    .status-text{font-size:11px;color:#888;display:flex;align-items:center}
    .link-ghin-btn{font-size:10px;letter-spacing:.1em;text-transform:uppercase;color:var(--gold);text-decoration:none;border:1px solid var(--gold);padding:4px 12px;border-radius:999px;cursor:pointer;background:none;transition:all .2s}
    .link-ghin-btn:hover{background:var(--tmac-bronze);color:#fff}
    .checklist-card{background:var(--white);border:1px solid var(--line);border-radius:20px;padding:28px;margin-bottom:28px}
    .checklist-progress{margin-bottom:20px}
    .checklist-progress-bar-bg{background:var(--tmac-blush-light);height:6px;border-radius:3px;margin-bottom:8px}
    .checklist-progress-bar{height:6px;border-radius:3px;background:linear-gradient(90deg,var(--tmac-gold),var(--tmac-bronze));transition:width .5s ease}
    .checklist-progress-label{font-size:11px;color:#888}
    .checklist-items{display:flex;flex-direction:column}
    .checklist-item{display:flex;align-items:center;gap:14px;padding:13px 0;border-bottom:1px solid rgba(0,0,0,.05);cursor:pointer}
    .checklist-item:last-child{border-bottom:none}
    .checklist-check{width:22px;height:22px;border-radius:50%;border:2px solid #ddd;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .2s}
    .checklist-check.done{border-color:var(--tmac-bronze);background:var(--tmac-bronze)}
    .checklist-check.done::after{content:'';width:6px;height:10px;border:2px solid #fff;border-top:none;border-left:none;transform:rotate(45deg) translateY(-1px)}
    .checklist-text{flex:1}
    .checklist-text-main{font-size:14px;color:var(--charcoal)}
    .checklist-text-main.done{text-decoration:line-through;color:#aaa}
    .checklist-text-sub{font-size:11px;color:#aaa;margin-top:2px}
    .checklist-action{font-size:11px;color:var(--tmac-bronze);text-decoration:none}
    .quick-actions{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:28px}
    .qa-item{background:var(--white);border:1px solid var(--line);border-radius:16px;padding:20px 12px;text-align:center;text-decoration:none;transition:all .25s;display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer}
    .qa-item:hover{transform:translateY(-3px);box-shadow:0 6px 16px rgba(0,0,0,.1)}
    .qa-icon{font-size:28px;line-height:1}
    .qa-label{font-size:11px;letter-spacing:.08em;text-transform:uppercase;color:var(--charcoal);font-weight:500}
    .qa-sub{font-size:10px;color:#aaa}
    .qa-item.highlight{background:var(--deep-forest)}
    .qa-item.highlight .qa-label,.qa-item.highlight .qa-sub{color:rgba(255,255,255,.8)}
    .vote-card{background:var(--white);border:1px solid var(--line);border-radius:20px;padding:28px;margin-bottom:28px}
    .vote-question{font-family:var(--serif);font-size:20px;color:var(--charcoal);margin-bottom:8px}
    .vote-subtext{font-size:12px;color:#888;margin-bottom:20px}
    .vote-options{display:flex;flex-direction:column;gap:10px}
    .vote-option{position:relative;border:1.5px solid var(--line);border-radius:12px;padding:14px 16px;cursor:pointer;transition:all .2s;overflow:hidden;display:flex;align-items:center;justify-content:space-between}
    .vote-option:hover{border-color:var(--tmac-bronze)}
    .vote-option.selected{border-color:var(--tmac-bronze);background:rgba(166,124,82,.04)}
    .vote-bar-fill{position:absolute;left:0;top:0;bottom:0;background:rgba(201,168,108,.12);transition:width .6s ease;pointer-events:none}
    .vote-option-label{font-size:14px;color:var(--charcoal);position:relative;z-index:1;font-weight:500}
    .vote-option-pct{font-size:13px;color:var(--tmac-bronze);position:relative;z-index:1;font-weight:500;display:none}
    .voted .vote-option-pct{display:block}
    .vote-submit-btn{margin-top:16px;background:linear-gradient(135deg,#C8A84B 0%,#E8D48A 35%,#F0E09A 50%,#D4A84A 70%,#B8922E 100%);color:var(--green);border:none;padding:14px 28px;font-size:12px;letter-spacing:.14em;text-transform:uppercase;cursor:pointer;width:100%;transition:all .2s;font-family:var(--sans);font-weight:700;border-radius:999px;box-shadow:0 8px 24px rgba(168,124,40,.26)}
    .vote-submit-btn:hover{opacity:.88}
    .vote-submit-btn:disabled{opacity:.4;cursor:default}
    .vote-thanks{text-align:center;padding:20px;font-family:'Cormorant Garamond',serif;font-size:18px;color:var(--tmac-bronze);display:none}
    .swag-card{background:var(--deep-forest);padding:28px;margin-bottom:28px;position:relative;overflow:hidden}
    .swag-card::after{content:'';position:absolute;right:24px;bottom:16px;font-size:64px;opacity:.15;line-height:1}
    .swag-eyebrow{font-size:10px;letter-spacing:.22em;text-transform:uppercase;color:var(--tmac-gold);margin-bottom:8px}
    .swag-title{font-family:'Cormorant Garamond',serif;font-size:24px;color:#fff;margin-bottom:6px}
    .swag-subtitle{font-size:12px;color:rgba(255,255,255,.5);margin-bottom:24px}
    .swag-items{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .swag-item{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);padding:16px 14px;text-align:center;cursor:pointer;transition:all .25s;text-decoration:none}
    .swag-item:hover{background:rgba(255,255,255,.12);transform:translateY(-2px)}
    .swag-item-icon{font-size:26px;margin-bottom:8px}
    .swag-item-name{font-size:11px;letter-spacing:.1em;text-transform:uppercase;color:rgba(255,255,255,.8);margin-bottom:4px}
    .swag-item-count{font-family:'Cormorant Garamond',serif;font-size:20px;color:var(--tmac-blush)}
    .swag-item-qty{font-size:10px;color:rgba(255,255,255,.4)}
    .rules-card{background:var(--white);border:1px solid var(--line);border-radius:20px;padding:28px;margin-bottom:28px}
    .rules-accordion-item{border-bottom:1px solid rgba(0,0,0,.06)}
    .rules-accordion-item:last-child{border-bottom:none}
    .rules-question{display:flex;align-items:center;justify-content:space-between;padding:14px 0;cursor:pointer;font-size:14px;font-weight:500;color:var(--charcoal);user-select:none}
    .rules-question:hover{color:var(--tmac-bronze)}
    .rules-chevron{width:16px;height:16px;border-right:2px solid currentColor;border-bottom:2px solid currentColor;transform:rotate(45deg);transition:transform .25s;flex-shrink:0;margin-left:12px}
    .rules-accordion-item.open .rules-chevron{transform:rotate(225deg)}
    .rules-answer{font-size:13px;color:#555;line-height:1.8;max-height:0;overflow:hidden;transition:max-height .35s ease,padding .2s;padding:0}
    .rules-accordion-item.open .rules-answer{max-height:300px;padding-bottom:16px}
    .mulligan-card{background:var(--off);border:1px solid var(--line);border-radius:20px;padding:28px;margin-bottom:28px}
    .mulligan-packages{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:20px}
    .mulligan-pkg{border:2px solid rgba(0,0,0,.08);padding:20px 16px;text-align:center;cursor:pointer;transition:all .2s;position:relative}
    .mulligan-pkg:hover{border-color:var(--tmac-gold)}
    .mulligan-pkg.popular{border-color:var(--tmac-bronze)}
    .mulligan-popular-tag{position:absolute;top:-11px;left:50%;transform:translateX(-50%);background:var(--tmac-bronze);color:#fff;font-size:9px;letter-spacing:.12em;text-transform:uppercase;padding:3px 10px;white-space:nowrap}
    .mulligan-count{font-family:var(--serif);font-size:40px;color:var(--charcoal);line-height:1;margin-bottom:4px}
    .mulligan-word{font-size:11px;letter-spacing:.12em;text-transform:uppercase;color:#888;margin-bottom:12px}
    .mulligan-price{font-size:18px;font-weight:500;color:var(--charcoal)}
    .mulligan-price-sub{font-size:11px;color:#aaa}
    .mulligan-buy-btn{margin-top:20px;width:100%;background:linear-gradient(135deg,#C8A84B 0%,#E8D48A 35%,#F0E09A 50%,#D4A84A 70%,#B8922E 100%);color:var(--green);border:none;padding:14px;font-size:12px;letter-spacing:.14em;text-transform:uppercase;cursor:pointer;font-family:var(--sans);transition:all .2s;font-weight:700;border-radius:999px;box-shadow:0 8px 24px rgba(168,124,40,.26)}
    .mulligan-buy-btn:hover{opacity:.88}
    .modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:500;align-items:center;justify-content:center;padding:24px}
    .modal-overlay.open{display:flex}
    .modal-box{background:var(--white);max-width:420px;width:100%;padding:36px;border-radius:20px;position:relative;animation:modalIn .25s ease;max-height:90vh;overflow-y:auto}
    @keyframes modalIn{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}
    .modal-close{position:absolute;top:16px;right:16px;background:none;border:none;font-size:20px;cursor:pointer;color:#999;line-height:1}
    .modal-eyebrow{font-size:10px;letter-spacing:.2em;text-transform:uppercase;color:var(--tmac-bronze);margin-bottom:8px}
    .modal-title{font-family:var(--serif);font-size:24px;color:var(--charcoal);margin-bottom:8px}
    .modal-body{font-size:13px;color:#555;line-height:1.8;margin-bottom:20px}
    .qr-display{text-align:center;padding:20px 0}
    .qr-canvas-wrap{background:var(--tmac-blush-light);padding:20px;display:inline-block;margin-bottom:12px}
    .qr-token{font-family:'Cormorant Garamond',serif;font-size:28px;color:var(--charcoal);letter-spacing:.1em;margin-bottom:4px}
    .qr-note{font-size:12px;color:#888}
    .announce-card{background:var(--white);border:1px solid var(--line);border-radius:20px;margin-bottom:28px;overflow:hidden}
    .announce-item{padding:18px 24px;border-bottom:1px solid rgba(0,0,0,.05);display:flex;gap:14px}
    .announce-item:last-child{border-bottom:none}
    .announce-dot{width:8px;height:8px;border-radius:50%;background:var(--tmac-bronze);flex-shrink:0;margin-top:6px}
    .announce-dot.new{background:#4caf50}
    .announce-title{font-size:14px;font-weight:500;color:var(--charcoal);margin-bottom:3px}
    .announce-text{font-size:13px;color:#666;line-height:1.6}
    .announce-date{font-size:11px;color:#bbb;margin-top:5px}
    .live-banner{display:none;background:linear-gradient(135deg,#c0392b,#a93226);padding:16px 24px;margin-bottom:24px;cursor:pointer;transition:all .3s;animation:livePulse 2s infinite;text-decoration:none}
    .live-banner.visible{display:flex;align-items:center;justify-content:space-between}
    @keyframes livePulse{0%,100%{box-shadow:0 4px 12px rgba(192,57,43,.2)}50%{box-shadow:0 4px 20px rgba(192,57,43,.4)}}
    .live-dot{width:10px;height:10px;border-radius:50%;background:#fff;animation:blink 1s infinite;margin-right:12px}
    @keyframes blink{0%,100%{opacity:1}50%{opacity:.4}}
    .live-label{font-size:13px;color:#fff;font-weight:500}
    .live-join{font-size:11px;letter-spacing:.12em;text-transform:uppercase;color:rgba(255,255,255,.8)}
    /* ── WALLET STYLES ── */
    .wallet-item{background:var(--white);border:1px solid var(--line);padding:20px 24px;display:flex;align-items:flex-start;gap:16px;transition:box-shadow .2s;margin-bottom:0}
    .wallet-item:hover{box-shadow:0 4px 12px rgba(0,0,0,.08)}
    .wallet-item.redeemed{border-color:rgba(76,175,80,.3)}
    .wallet-item.soldout{opacity:.6}
    @media(max-width:640px){
      .hub-container{padding:24px 16px 120px}
      .countdown-inner{flex-direction:column;align-items:flex-start;gap:20px}
      .cd-num{font-size:34px}
      .quick-actions{grid-template-columns:repeat(2,1fr)}
      .swag-items{grid-template-columns:repeat(2,1fr)}
      .mulligan-packages{grid-template-columns:1fr;gap:20px}
      .welcome-strip{flex-direction:column;align-items:flex-start;gap:12px}
      .modal-box{padding:24px}
    }
  </style>
</head>

<body class="member-body">
  <header class="member-header">
    <div class="header-inner">
      <a href="/home.html" class="header-logo">
        <img src="images/tmac-logo.png" alt="TMac Inspired">
      </a>
      <nav class="header-nav">
        <a href="/home.html" class="nav-link active">Hub</a>
        <a href="/tee-room.html" class="nav-link">Tee Room</a>
        <a href="/members.html" class="nav-link">The Circle</a>
        <a href="/tee-elite-invitational.html" class="nav-link">The Invitational</a>
      </nav>
      <div class="header-user">
        <a href="/profile.html" class="user-avatar" id="user-avatar">
          <span id="user-initials">TM</span>
        </a>
      </div>
      <button class="mobile-menu-btn" id="mobile-menu-btn">
        <span></span><span></span><span></span>
      </button>
    </div>
  </header>

  <div class="mobile-nav" id="mobile-nav">
    <a href="/home.html" class="mobile-nav-link active">Hub</a>
    <a href="/tee-room.html" class="mobile-nav-link">Tee Room</a>
    <a href="/members.html" class="mobile-nav-link">The Circle</a>
    <a href="/tee-elite-invitational.html" class="mobile-nav-link">The Invitational</a>
    <a href="/profile.html" class="mobile-nav-link">My Profile</a>
    <a href="#" class="mobile-nav-link" id="logout-link">Log Out</a>
  </div>

  <main class="hub-container">
    <a href="/live.html" class="live-banner" id="live-banner">
      <div style="display:flex;align-items:center;">
        <div class="live-dot"></div>
        <span class="live-label">Dr. TMac is LIVE</span>
      </div>
      <span class="live-join">Join Now →</span>
    </a>
    <div class="sticky-progress" id="sticky-progress">
  <div class="sp-bar-bg"><div class="sp-bar" id="sp-bar"></div></div>
  <div class="sp-label" id="sp-label">0 of 6 ready</div>
</div>

<div class="welcome-strip">
  <div>
    <div class="welcome-label">Welcome back</div>
    <div class="welcome-name" id="member-name">Player</div>
  </div>
  <div class="member-badge" id="member-badge">Invitational Member</div>
</div>

<div class="countdown-banner">
  <div class="countdown-inner">
    <div>
      <div class="countdown-eyebrow">T-minus</div>
      <div class="countdown-title">Tee Elite Circle Invitational</div>
      <div class="countdown-date-str">Saturday, April 18, 2026 · Summerfield Crossing Golf Club</div>
    </div>
    <div class="countdown-digits">
      <div class="cd-unit"><span class="cd-num" id="cd-days">--</span><div class="cd-label">Days</div></div>
      <div class="cd-unit"><span class="cd-num" id="cd-hrs">--</span><div class="cd-label">Hrs</div></div>
      <div class="cd-unit"><span class="cd-num" id="cd-min">--</span><div class="cd-label">Min</div></div>
    </div>
  </div>
</div>

<div class="section-head"><span class="section-label">Quick Access</span></div>
<div class="quick-actions">
  <button class="qa-item" onclick="openModal('swag-modal')">
    <div class="qa-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg></div><div class="qa-label">Swag Bag</div><div class="qa-sub">Your perks</div>
  </button>
  <button class="qa-item" onclick="openModal('drink-modal')">
    <div class="qa-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M8 22h8M12 11v11M5 2h14l-2 9a5 5 0 01-10 0L5 2z"/></svg></div><div class="qa-label">Drink Tickets</div><div class="qa-sub" id="drink-count-display">1 remaining</div>
  </button>
  <button class="qa-item highlight" onclick="openModal('mulligan-modal')">
    <div class="qa-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 102.13-9.36L1 10"/></svg></div><div class="qa-label">Mulligans</div><div class="qa-sub" id="mulligan-count-display">Add more</div>
  </button>
  <a class="qa-item" href="/members.html">
    <div class="qa-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg></div><div class="qa-label">The Circle</div><div class="qa-sub">Meet your crew</div>
  </a>
</div>

<div class="section-head">
  <span class="section-label">Your Team</span>
  <a class="section-link" href="/members.html">View all →</a>
</div>
<div class="team-card">
  <div class="team-header">
    <div>
      <div class="team-tag">Scramble Team</div>
      <div class="team-name" id="team-name">Loading…</div>
    </div>
    <div class="team-ready-pill" id="team-pill">—</div>
  </div>
  <div class="team-members-list" id="team-members-list">
    <div style="text-align:center;padding:32px 16px;">
      <p style="font-size:14px;color:#888;margin-bottom:8px;">Team assignments are being finalized.</p>
      <small style="font-size:12px;color:#aaa;">You'll be notified once your team is set. Check back soon!</small>
    </div>
  </div>
</div>

<div class="section-head">
  <span class="section-label">Preparation Checklist</span>
  <span class="section-link" id="checklist-progress-text">0 of 6 done</span>
</div>
<div class="checklist-card">
  <div class="checklist-progress">
    <div class="checklist-progress-bar-bg">
      <div class="checklist-progress-bar" id="checklist-bar" style="width:0%"></div>
    </div>
    <div class="checklist-progress-label" id="checklist-pct">0% ready — let's get you set!</div>
  </div>
  <div class="checklist-items" id="checklist-items"></div>
</div>

<div class="section-head"><span class="section-label">Community Vote</span></div>
<div class="vote-card">
  <div class="vote-question">Should we host a Pairing Party before the Invitational?</div>
  <div class="vote-subtext">A pre-event mixer to meet your team, share a drink, and shake off the nerves. Cast your vote — results are live.</div>
  <div class="vote-options" id="vote-options">
    <div class="vote-option" data-option="A" onclick="selectVote(this)">
      <div class="vote-bar-fill" style="width:0%"></div>
      <span class="vote-option-label">Yes — let's party before we play</span>
      <span class="vote-option-pct">—</span>
    </div>
    <div class="vote-option" data-option="B" onclick="selectVote(this)">
      <div class="vote-bar-fill" style="width:0%"></div>
      <span class="vote-option-label">No — I'll save my energy for the course</span>
      <span class="vote-option-pct">—</span>
    </div>
  </div>
  <div style="font-size:11px;color:#bbb;margin-top:10px;text-align:right;" id="vote-total-label"></div>
  <button class="vote-submit-btn" id="vote-btn" onclick="submitVote()" disabled>Cast My Vote</button>
  <div class="vote-thanks" id="vote-thanks">✓ Vote recorded. Results update in real time.</div>
</div>



<div class="section-head"><span class="section-label">Announcements</span></div>
<div class="announce-card" id="announce-list">
  <div class="announce-item">
    <div class="announce-dot new"></div>
    <div class="announce-content">
      <div class="announce-title">Welcome to the Invitational Hub!</div>
      <div class="announce-text">Your registration is confirmed. Explore your swag bag, link your GHIN handicap, and get ready for an exceptional day on the green.</div>
      <div class="announce-date">Just posted</div>
    </div>
  </div>
  <div class="announce-item">
    <div class="announce-dot"></div>
    <div class="announce-content">
      <div class="announce-title">Mulligan packages now available</div>
      <div class="announce-text">Purchase mulligans in advance for $5 each. Max 2 per player. Available at registration and on-course via CashApp.</div>
      <div class="announce-date">Today</div>
    </div>
  </div>
</div>

  </main>

  <nav class="pwa-bottom-nav">
    <div class="pwa-bottom-nav-inner">
      <a href="/home.html" class="pwa-nav-item active">
        <svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>Hub
      </a>
      <a href="/tee-room.html" class="pwa-nav-item">
        <svg viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>Tee Room
      </a>
      <a href="/members.html" class="pwa-nav-item">
        <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>Circle
      </a>
      <a href="/profile.html" class="pwa-nav-item">
        <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>Profile
      </a>
    </div>
  </nav>

  <!-- MODALS -->

  <div class="modal-overlay" id="swag-modal" onclick="closeModalOnBg(event,'swag-modal')">
    <div class="modal-box" style="max-width:580px;padding:0;overflow:hidden;">
      <button class="modal-close" onclick="closeModal('swag-modal')" style="top:16px;right:16px;z-index:2;">✕</button>
      <!-- Wallet header -->
      <div style="background:var(--deep-forest);padding:28px 32px;position:relative;overflow:hidden;">
        <div style="position:absolute;top:0;right:0;bottom:0;width:4px;background:linear-gradient(180deg,var(--tmac-gold),var(--tmac-blush));"></div>
        <div style="font-size:10px;letter-spacing:.22em;text-transform:uppercase;color:var(--tmac-gold);margin-bottom:6px;">Tee Elite Invitational 2026</div>
        <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
          <div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:48px;color:#fff;line-height:1;" id="wallet-balance-display">100</div>
            <div style="font-size:12px;color:rgba(255,255,255,.5);margin-top:4px;">Scramble Points <span id="wallet-spent-display" style="display:none;color:rgba(201,168,108,.7);margin-left:6px;"></span></div>
          </div>
          <div style="text-align:right;">
            <div id="wallet-status-badge" style="font-size:10px;letter-spacing:.16em;text-transform:uppercase;padding:6px 14px;display:inline-block;margin-bottom:8px;background:rgba(201,168,108,.15);color:var(--tmac-gold);border-radius:999px;">Unlocks April 18</div>
            <div style="font-size:11px;color:rgba(255,255,255,.4);" id="wallet-expiry-label">Browse &amp; wishlist below</div>
          </div>
        </div>
        <div style="margin-top:16px;">
          <div style="background:rgba(255,255,255,.1);height:4px;border-radius:2px;">
            <div id="wallet-points-bar" style="height:4px;border-radius:2px;background:linear-gradient(90deg,var(--tmac-gold),var(--tmac-blush));width:100%;transition:width .6s ease;"></div>
          </div>
        </div>
      </div>
      <!-- Locked notice -->
      <div id="wallet-locked-notice" style="background:rgba(201,168,108,.08);border-bottom:1px solid rgba(201,168,108,.2);padding:14px 32px;">
        <div style="font-size:13px;color:var(--charcoal);line-height:1.7;">Unlocks on <strong>April 18, 2026</strong>. Browse below and wishlist what you want — your picks help us prepare.</div>
      </div>
      <!-- Wishlist summary -->
      <div id="wishlist-summary" style="display:none;padding:12px 32px;background:rgba(22,51,38,.04);border-bottom:1px solid var(--line);">
        <div style="font-size:11px;letter-spacing:.14em;text-transform:uppercase;color:var(--gold);margin-bottom:6px;">Your Wishlist</div>
        <div id="wishlist-summary-items" style="font-size:13px;color:var(--charcoal);line-height:1.8;"></div>
      </div>
      <!-- Marketplace -->
      <div style="padding:20px 32px 32px;max-height:50vh;overflow-y:auto;">
        <div style="font-size:10px;letter-spacing:.18em;text-transform:uppercase;color:var(--tmac-bronze);margin-bottom:14px;padding-bottom:8px;border-bottom:1px solid rgba(166,124,82,.15);">Scramble Marketplace</div>
        <div id="marketplace-grid" style="display:flex;flex-direction:column;gap:1px;border:1px solid rgba(0,0,0,.06);">
          <div style="text-align:center;padding:32px;color:#aaa;font-size:13px;">Loading your marketplace...</div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="drink-modal" onclick="closeModalOnBg(event,'drink-modal')">
    <div class="modal-box" style="text-align:center;">
      <button class="modal-close" onclick="closeModal('drink-modal')">✕</button>
      <div class="modal-eyebrow">Digital Drink Ticket</div>
      <div class="modal-title">Show this at the bar</div>
      <div class="qr-display">
        <div class="qr-canvas-wrap"><canvas id="drink-qr" width="160" height="160"></canvas></div>
        <div class="qr-token" id="drink-token">—</div>
        <div class="qr-note">Staff will scan or enter your code.<br>Each scan redeems 1 ticket.</div>
      </div>
      <div class="modal-body" style="margin-top:16px;">
        You have <strong id="drink-remaining">1</strong> drink ticket(s) remaining.
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="mulligan-modal" onclick="closeModalOnBg(event,'mulligan-modal')">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('mulligan-modal')">✕</button>
      <div class="modal-eyebrow">Mulligan Packages</div>
      <div class="modal-title">Take the shot again.</div>
      <div class="modal-body">$5 each. Max 1 on the front 9, max 1 on the back 9. Not valid on contest holes. Non-transferable.</div>
      <div class="mulligan-packages">
        <div class="mulligan-pkg" onclick="selectMulligan(this,1,5)">
          <div class="mulligan-count">1</div>
          <div class="mulligan-word">Mulligan</div>
          <div class="mulligan-price">$5</div>
        </div>
        <div class="mulligan-pkg popular" onclick="selectMulligan(this,2,10)">
          <div class="mulligan-popular-tag">Max per player</div>
          <div class="mulligan-count">2</div>
          <div class="mulligan-word">Mulligans</div>
          <div class="mulligan-price">$10</div>
          <div class="mulligan-price-sub">1 front · 1 back</div>
        </div>
      </div>
      <div id="cashapp-pay" style="display:none;margin-top:24px;text-align:center;">
        <div style="font-size:11px;letter-spacing:.16em;text-transform:uppercase;color:var(--tmac-bronze);margin-bottom:12px;">Pay via CashApp</div>
        <img src="/images/CashApp.jpg" alt="CashApp QR Code" style="width:180px;height:180px;object-fit:cover;display:block;margin:0 auto 12px;">
        <div style="font-family:'Cormorant Garamond',serif;font-size:22px;color:var(--charcoal);margin-bottom:6px;">$TMacinspired</div>
        <div style="font-size:12px;color:#888;line-height:1.7;">Scan the QR code or search <strong>$TMacinspired</strong> in CashApp.<br>Show your receipt to a volunteer or at the registration desk.</div>
      </div>
      <button class="mulligan-buy-btn" id="mulligan-buy-btn" disabled onclick="showCashApp()">Select a Package</button>
    </div>
  </div>

  <div class="modal-overlay" id="contest-modal" onclick="closeModalOnBg(event,'contest-modal')">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('contest-modal')">✕</button>
      <div class="modal-eyebrow">On-Course Contests</div>
      <div class="modal-title">Four ways to shine.</div>
      <div class="modal-body" style="line-height:2.4;">
        <strong>Closest to the Pin — Hole 2</strong><br>Par 3. One shot to the flag.<br><br>
        <strong>Closest to the Pin — Hole 8</strong><br>Par 3. Precision counts.<br><br>
        <strong>Closest to the Pin — Hole 12</strong><br>Par 3. Stay locked in.<br><br>
        <strong>Closest to the Pin — Hole 15</strong><br>Par 3. Final chance to shine.<br><br>
        <strong>Longest Drive — Hole 9</strong><br>Drive must stay in the fairway to count.
      </div>
      <div style="font-size:12px;color:#aaa;">Mulligans are not permitted on contest holes. Winners announced at the awards ceremony.</div>
    </div>
  </div>

  <div class="modal-overlay" id="rules-modal" onclick="closeModalOnBg(event,'rules-modal')">
    <div class="modal-box" style="max-width:520px;">
      <button class="modal-close" onclick="closeModal('rules-modal')">✕</button>
      <div class="modal-eyebrow">Format and Rules</div>
      <div class="modal-title">Scramble — How It Works</div>
      <div style="margin-top:16px;">
        <div class="rules-accordion-item">
          <div class="rules-question" onclick="toggleAccordion(this)">What is a scramble?<div class="rules-chevron"></div></div>
          <div class="rules-answer">All 4 players tee off. The team selects the best shot and everyone plays their next shot from that spot. Repeat until holed. Fast, fun, and open to all skill levels!</div>
        </div>
        <div class="rules-accordion-item">
          <div class="rules-question" onclick="toggleAccordion(this)">Tee box rules<div class="rules-chevron"></div></div>
          <div class="rules-answer">All players use the ladies tees. Each player must contribute a minimum of 2 tee shots per 9 holes — everyone's drive counts.</div>
        </div>
        <div class="rules-accordion-item">
          <div class="rules-question" onclick="toggleAccordion(this)">Scoring and handicaps<div class="rules-chevron"></div></div>
          <div class="rules-answer">Score is recorded as the team score. Handicaps are used for pairing purposes only. Please link your GHIN in the app before the event.</div>
        </div>
        <div class="rules-accordion-item">
          <div class="rules-question" onclick="toggleAccordion(this)">Mulligan rules<div class="rules-chevron"></div></div>
          <div class="rules-answer">One mulligan = one do-over shot for any player. The team then selects from all available shots including the mulligan. Maximum 6 mulligans per team.</div>
        </div>
        <div class="rules-accordion-item">
          <div class="rules-question" onclick="toggleAccordion(this)">Pace of play<div class="rules-chevron"></div></div>
          <div class="rules-answer">We are playing ready golf. If your team falls more than one hole behind, a ranger may ask you to skip ahead. Everyone finishes in time for dinner!</div>
        </div>
        <div class="rules-accordion-item">
          <div class="rules-question" onclick="toggleAccordion(this)">Dress code<div class="rules-chevron"></div></div>
          <div class="rules-answer">White is the base. Gold or green accent. Collared shirts required. Soft spikes or spikeless shoes. Look like you're ready to win.</div>
        </div>
      </div>
      <div style="margin-top:16px;">
        <button onclick="updateChecklistItem('rules',true);closeModal('rules-modal')" style="background:linear-gradient(135deg,#C8A84B 0%,#E8D48A 35%,#F0E09A 50%,#D4A84A 70%,#B8922E 100%);color:var(--green);border:none;padding:12px 24px;font-size:11px;letter-spacing:.15em;text-transform:uppercase;cursor:pointer;font-family:inherit;width:100%;border-radius:999px;font-weight:700;">
          Mark as Reviewed ✓
        </button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="playbook-modal" onclick="closeModalOnBg(event,'playbook-modal')">
    <div class="modal-box" style="text-align:center;">
      <button class="modal-close" onclick="closeModal('playbook-modal')">✕</button>
      <div class="modal-eyebrow">Event Playbook</div>
      <div class="modal-title">Your full day guide</div>
      <div class="modal-body">Everything you need for April 18 — schedule, rules, contest holes, attire, and Dr. TMac's welcome letter.</div>
      <a href="/playbook.html" style="display:inline-block;background:linear-gradient(135deg,#C8A84B 0%,#E8D48A 35%,#F0E09A 50%,#D4A84A 70%,#B8922E 100%);color:var(--green);padding:14px 32px;font-size:11px;letter-spacing:.18em;text-transform:uppercase;text-decoration:none;margin-top:8px;border-radius:999px;font-weight:700;">
        Open Playbook
      </a>
    </div>
  </div>

  <div class="modal-overlay" id="dress-modal" onclick="closeModalOnBg(event,'dress-modal')">
    <div class="modal-box" style="text-align:center;">
      <button class="modal-close" onclick="closeModal('dress-modal')">✕</button>
      <div class="modal-eyebrow">Dress Code</div>
      <div class="modal-title">Dress like you belong.</div>
      <div class="modal-body" style="text-align:left;line-height:2.2;">
        <strong>Base color:</strong> White (required)<br>
        <strong>Accent:</strong> Gold or green (encouraged)<br>
        <strong>Tops:</strong> Collared polo or golf-appropriate blouse<br>
        <strong>Bottoms:</strong> Golf skirt, shorts, or pants<br>
        <strong>Shoes:</strong> Soft spikes or spikeless golf shoes<br>
        <strong>Accessories:</strong> The goldie-er the better!
      </div>
      <button onclick="updateChecklistItem('dress',true);closeModal('dress-modal')" style="background:linear-gradient(135deg,#C8A84B 0%,#E8D48A 35%,#F0E09A 50%,#D4A84A 70%,#B8922E 100%);color:var(--green);border:none;padding:12px 24px;font-size:11px;letter-spacing:.15em;text-transform:uppercase;cursor:pointer;font-family:inherit;width:100%;border-radius:999px;font-weight:700;">
        Got It — Outfit Packed ✓
      </button>
    </div>
  </div>

  <div class="modal-overlay" id="ghin-modal" onclick="closeModalOnBg(event,'ghin-modal')">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('ghin-modal')">✕</button>
      <div class="modal-eyebrow">Link Your Handicap</div>
      <div class="modal-title">Connect your GHIN</div>
      <div class="modal-body">Your GHIN number is used for pairing purposes. Enter it below.</div>
      <form onsubmit="submitGHIN(event)" id="ghin-form">
        <div style="margin-bottom:16px;">
          <label style="font-size:12px;letter-spacing:.1em;text-transform:uppercase;color:#888;display:block;margin-bottom:6px;">Your GHIN Number</label>
          <input type="text" id="ghin-input" placeholder="e.g. 1234567" style="width:100%;padding:12px 14px;border:1px solid #ddd;font-size:15px;font-family:inherit;outline:none;">
        </div>
        <button type="submit" style="width:100%;background:linear-gradient(135deg,#C8A84B 0%,#E8D48A 35%,#F0E09A 50%,#D4A84A 70%,#B8922E 100%);color:var(--green);border:none;padding:14px;font-size:11px;letter-spacing:.18em;text-transform:uppercase;cursor:pointer;font-family:inherit;border-radius:999px;font-weight:700;">Link My GHIN</button>
        <div style="text-align:center;margin-top:12px;font-size:12px;color:#aaa;">
          No GHIN? <a href="https://www.ghin.com" target="_blank" style="color:var(--tmac-bronze);">Register at ghin.com</a>
        </div>
      </form>
      <div id="ghin-success" style="display:none;text-align:center;padding:16px;font-family:'Cormorant Garamond',serif;font-size:18px;color:var(--tmac-bronze);">✓ GHIN linked successfully!</div>
    </div>
  </div>

  <!-- WALLET REDEMPTION CONFIRMATION MODAL -->

  <div class="modal-overlay" id="redeem-confirm-modal" onclick="closeModalOnBg(event,'redeem-confirm-modal')">
    <div class="modal-box" style="max-width:460px;">
      <button class="modal-close" onclick="closeModal('redeem-confirm-modal')">✕</button>
      <div id="redeem-confirm-content"></div>
    </div>
  </div>

  <script>
    let memberData = null;
    let mulliganSelected = null;

    async function loadMember() {
      try {
        const res = await fetch('/api/members/me');
        if (!res.ok) { window.location.href = '/member-login.html'; return; }
        memberData = await res.json();
        document.getElementById('member-name').textContent = memberData.name || 'Player';
        document.getElementById('user-initials').textContent = getInitials(memberData.name);
        const mulligans = memberData.mulligans_purchased || 0;
        document.getElementById('mulligan-count-display').textContent = mulligans ? mulligans + ' owned' : 'Add more';
        const tickets = memberData.drink_tickets ?? 1;
        document.getElementById('drink-count-display').textContent = tickets + ' remaining';
        document.getElementById('drink-remaining').textContent = tickets;
        
        if (mulligans > 0) updateChecklistItem('mulligans', true);
        buildDrinkQR();
        loadTeam();
        loadWallet();
      } catch (e) {
        window.location.href = '/member-login.html';
      }
    }

    function getInitials(name) {
      if (!name) return 'TM';
      return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
    }

    function tick() {
      const target = new Date('2026-04-18T08:00:00-04:00');
      const diff = target - new Date();
      if (diff <= 0) return;
      document.getElementById('cd-days').textContent = Math.floor(diff / 86400000);
      document.getElementById('cd-hrs').textContent = Math.floor((diff % 86400000) / 3600000);
      document.getElementById('cd-min').textContent = Math.floor((diff % 3600000) / 60000);
    }
    tick(); setInterval(tick, 60000);

    async function loadTeam() {
      const listEl = document.getElementById('team-members-list');
      const nameEl = document.getElementById('team-name');
      const pillEl = document.getElementById('team-pill');
      if (memberData?.team_name) {
        nameEl.textContent = memberData.team_name;
        try {
          const res = await fetch('/api/members/team');
          if (res.ok) { renderTeamMembers(await res.json(), listEl, pillEl); return; }
        } catch(e) {}
      }
      nameEl.textContent = 'Team TBD';
      pillEl.textContent = 'Pending'; pillEl.className = 'team-ready-pill pill-warn';
      listEl.innerHTML = `
        <div class="team-member-row">
          <div class="tm-avatar">${getInitials(memberData?.name)}</div>
          <div class="tm-info">
            <div class="tm-name">${memberData?.name || 'You'} <span style="font-size:11px;color:#aaa;">(you)</span></div>
            <div class="tm-hcp">${memberData?.ghin ? 'GHIN: ' + memberData.ghin : 'GHIN not linked'}</div>
          </div>
          <div class="tm-status">${memberData?.ghin
            ? '<span class="status-text"><span class="status-dot dot-green"></span>Ready</span>'
            : '<button class="link-ghin-btn" onclick="openModal(\'ghin-modal\')">Link GHIN</button>'}</div>
        </div>
        ${[2,3,4].map(n => `<div class="team-member-row" style="opacity:.35;">
          <div class="tm-avatar" style="background:#eee;">?</div>
          <div class="tm-info"><div class="tm-name">Teammate ${n}</div><div class="tm-hcp">Awaiting assignment</div></div>
        </div>`).join('')}`;
    }

    function renderTeamMembers(team, listEl, pillEl) {
      const allReady = team.every(m => m.ghin);
      const someReady = team.some(m => m.ghin);
      pillEl.textContent = allReady ? 'All Ready' : someReady ? 'In Progress' : 'Action Needed';
      pillEl.className = 'team-ready-pill ' + (allReady ? 'pill-good' : someReady ? 'pill-warn' : 'pill-alert');
      listEl.innerHTML = team.map(m => `
        <div class="team-member-row">
          <div class="tm-avatar">${getInitials(m.name)}</div>
          <div class="tm-info"><div class="tm-name">${m.name}</div><div class="tm-hcp">${m.ghin ? 'GHIN: ' + m.ghin : 'GHIN not linked'}</div></div>
          <div class="tm-status"><span class="status-text"><span class="status-dot ${m.ghin ? 'dot-green' : 'dot-yellow'}"></span>${m.ghin ? 'Ready' : 'Needs GHIN'}</span></div>
        </div>`).join('');
    }

    const CHECKLIST = [
      { id: 'registration', label: 'Registration complete', sub: "You're confirmed!", locked: true },
      { id: 'ghin', label: 'Link your GHIN handicap', sub: 'Required for scramble scoring', action: () => openModal('ghin-modal') },
      { id: 'team', label: 'Meet your team', sub: 'Assignments coming soon', action: () => location.href='/members.html' },
      { id: 'rules', label: 'Review scramble rules', sub: '5 min read — know before you go', action: () => openModal('rules-modal') },
      { id: 'dress', label: 'Pack your outfit', sub: 'White + gold or green accent', action: () => openModal('dress-modal') },
      { id: 'mulligans', label: 'Consider mulligan package', sub: 'Purchase in advance or at registration', action: () => openModal('mulligan-modal') },
    ];

    function getChecklistState() {
      try { return JSON.parse(localStorage.getItem('tee_checklist') || '{}'); } catch(e) { return {}; }
    }
    function setChecklistState(s) { localStorage.setItem('tee_checklist', JSON.stringify(s)); }

    function updateChecklistItem(id, done) {
      const s = getChecklistState(); s[id] = done; setChecklistState(s); renderChecklist();
    }

    function renderChecklist() {
      const s = getChecklistState();
      s.registration = true;
      if (memberData?.mulligans_purchased > 0) s.mulligans = true;
      const container = document.getElementById('checklist-items');
      container.innerHTML = CHECKLIST.map(item => {
        const done = s[item.id] ?? false;
        return '<div class="checklist-item" onclick="' + (item.locked ? '' : item.action ? 'handleCL(\'' + item.id + '\')' : 'toggleCL(\'' + item.id + '\')') + '"><div class="checklist-check ' + (done ? 'done' : '') + '"></div><div class="checklist-text"><div class="checklist-text-main ' + (done ? 'done' : '') + '">' + item.label + '</div><div class="checklist-text-sub">' + item.sub + '</div></div>' + (item.action && !done ? '<span class="checklist-action">\u2192</span>' : '') + '</div>';
      }).join('');
      const doneCount = CHECKLIST.filter(i => s[i.id]).length;
      const pct = Math.round(doneCount / CHECKLIST.length * 100);
      document.getElementById('checklist-bar').style.width = pct + '%';
      document.getElementById('checklist-pct').textContent = pct === 100 ? '100% ready — see you on the green.' : pct + '% ready — keep going!';
      document.getElementById('checklist-progress-text').textContent = doneCount + ' of ' + CHECKLIST.length + ' done';
      var spBar = document.getElementById('sp-bar');
      var spLabel = document.getElementById('sp-label');
      if (spBar) spBar.style.width = pct + '%';
      if (spLabel) spLabel.textContent = doneCount + ' of ' + CHECKLIST.length + ' ready';
    }

    function handleCL(id) { const item = CHECKLIST.find(i => i.id === id); if (item && item.action) item.action(); }
    function toggleCL(id) { const s = getChecklistState(); s[id] = !s[id]; setChecklistState(s); renderChecklist(); }

    const POLL_ID = 'pairing-party-2026';
    let selectedVote = null;
    let hasVoted = false;

    function renderVoteTallies(counts, total, myVote) {
      document.querySelectorAll('.vote-option').forEach(opt => {
        const key = opt.dataset.option;
        const count = counts[key] || 0;
        const pct = total > 0 ? Math.round(count / total * 100) : 0;
        opt.querySelector('.vote-bar-fill').style.width = pct + '%';
        opt.querySelector('.vote-option-pct').textContent = pct + '%';
        opt.classList.add('voted');
        opt.onclick = null;
        if (key === myVote) opt.classList.add('selected');
      });
      const label = document.getElementById('vote-total-label');
      if (label) label.textContent = total + (total === 1 ? ' vote' : ' votes');
    }

    async function loadVote() {
      try {
        const res = await fetch('/api/vote?poll_id=' + POLL_ID);
        if (!res.ok) return;
        const data = await res.json();
        if (data.myVote) {
          hasVoted = true;
          renderVoteTallies(data.counts, data.total, data.myVote);
          document.getElementById('vote-btn').style.display = 'none';
          document.getElementById('vote-thanks').style.display = 'block';
        } else if (data.total > 0) {
          renderVoteTallies(data.counts, data.total, null);
          document.querySelectorAll('.vote-option').forEach(opt => {
            opt.classList.remove('voted');
            opt.onclick = () => selectVote(opt);
          });
          const label = document.getElementById('vote-total-label');
          if (label) label.textContent = data.total + (data.total === 1 ? ' vote so far' : ' votes so far');
        }
      } catch(e) { console.error('Vote load error', e); }
    }

    function selectVote(el) {
      if (hasVoted) return;
      document.querySelectorAll('.vote-option').forEach(o => o.classList.remove('selected'));
      el.classList.add('selected');
      selectedVote = el.dataset.option;
      document.getElementById('vote-btn').disabled = false;
    }

    async function submitVote() {
      if (!selectedVote || hasVoted) return;
      const btn = document.getElementById('vote-btn');
      btn.disabled = true;
      btn.textContent = 'Submitting\u2026';
      try {
        const res = await fetch('/api/vote', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ poll_id: POLL_ID, option: selectedVote })
        });
        if (!res.ok) throw new Error('Vote failed');
        const data = await res.json();
        hasVoted = true;
        renderVoteTallies(data.counts, data.total, data.myVote);
        btn.style.display = 'none';
        document.getElementById('vote-thanks').style.display = 'block';
      } catch(e) {
        btn.disabled = false;
        btn.textContent = 'Cast My Vote';
        console.error('Vote submit error', e);
      }
    }

    function buildDrinkQR() {
      const canvas = document.getElementById('drink-qr');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      const token = memberData && memberData.id ? 'TEI-' + String(memberData.id).padStart(4, '0') : 'TEI-XXXX';
      document.getElementById('drink-token').textContent = token;
      ctx.fillStyle = '#fff'; ctx.fillRect(0, 0, 160, 160);
      let seed = token.split('').reduce((a, c) => a + c.charCodeAt(0), 0);
      function rng() { seed = (seed * 1664525 + 1013904223) & 0xffffffff; return (seed >>> 0) / 0xffffffff; }
      const s = 10;
      ctx.fillStyle = '#1a2f23';
      [[0,0],[13,0],[0,13]].forEach(function(pos) {
        var cx = pos[0], cy = pos[1];
        ctx.fillRect(cx*s, cy*s, 3*s, 3*s);
        ctx.fillStyle = '#fff'; ctx.fillRect((cx+1)*s, (cy+1)*s, s, s);
        ctx.fillStyle = '#1a2f23';
      });
      for (var r = 3; r < 13; r++) for (var c = 3; c < 16; c++) {
        if (rng() > 0.5) ctx.fillRect(c*s, r*s, s, s);
      }
    }

    function selectMulligan(el, count, price) {
      document.querySelectorAll('.mulligan-pkg').forEach(p => p.style.boxShadow = '');
      el.style.boxShadow = '0 0 0 2px var(--tmac-bronze)';
      mulliganSelected = { count: count, price: price };
      const btn = document.getElementById('mulligan-buy-btn');
      btn.textContent = 'Pay $' + price + ' via CashApp';
      btn.disabled = false;
      document.getElementById('cashapp-pay').style.display = 'none';
    }

    function showCashApp() {
      if (!mulliganSelected) return;
      document.getElementById('cashapp-pay').style.display = 'block';
      document.getElementById('mulligan-buy-btn').style.display = 'none';
    }

    async function submitGHIN(e) {
      e.preventDefault();
      const ghin = document.getElementById('ghin-input').value.trim();
      if (!ghin) return;
      try {
        const res = await fetch('/api/members/update-ghin', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ ghin: ghin })
        });
        if (res.ok) {
          document.getElementById('ghin-success').style.display = 'block';
          document.getElementById('ghin-form').style.display = 'none';
          if (memberData) memberData.ghin = ghin;
          updateChecklistItem('ghin', true);
          setTimeout(() => closeModal('ghin-modal'), 1800);
        }
      } catch(err) { console.error(err); }
    }

    function openModal(id) {
      document.getElementById(id).classList.add('open');
      document.body.style.overflow = 'hidden';
    }
    function closeModal(id) {
      document.getElementById(id).classList.remove('open');
      document.body.style.overflow = '';
      if (id === 'mulligan-modal') {
        document.getElementById('cashapp-pay').style.display = 'none';
        const btn = document.getElementById('mulligan-buy-btn');
        btn.style.display = 'block';
        btn.disabled = true;
        btn.textContent = 'Select a Package';
        mulliganSelected = null;
        document.querySelectorAll('.mulligan-pkg').forEach(p => p.style.boxShadow = '');
      }
    }
    function closeModalOnBg(e, id) { if (e.target === document.getElementById(id)) closeModal(id); }
    function toggleAccordion(trigger) {
      const item = trigger.closest('.rules-accordion-item');
      const isOpen = item.classList.contains('open');
      document.querySelectorAll('.rules-accordion-item').forEach(i => i.classList.remove('open'));
      if (!isOpen) item.classList.add('open');
    }

    document.getElementById('mobile-menu-btn').addEventListener('click', function() {
      this.classList.toggle('active');
      document.getElementById('mobile-nav').classList.toggle('open');
    });
    document.getElementById('logout-link').addEventListener('click', async function(e) {
      e.preventDefault();
      await fetch('/api/auth/logout', { method: 'POST' });
      window.location.href = '/member-login.html';
    });

    async function checkLive() {
      try {
        const res = await fetch('/api/live/status');
        if (res.ok) { const s = await res.json(); if (s.is_live) document.getElementById('live-banner').classList.add('visible'); }
      } catch(e) {}
    }

    // ══ SCRAMBLE WALLET ══════════════════════════════════════════════
    var walletData = null;

    var WALLET_ITEMS = []; // loaded from DB via /api/wallet-items

    // SVG icons keyed by item id (fallback for items without custom icons)
    var ITEM_ICONS = {
      playlist:    '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>',
      priority:    '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>',
      vault:       '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/><line x1="12" y1="12" x2="12" y2="16"/><circle cx="12" cy="12" r="1"/></svg>',
      ray:         '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>',
      roundtable:  '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>',
      sprint:      '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 8 12 12 14 14"/></svg>',
      _default:    '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--tmac-bronze)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>'
    };

    async function loadWalletItems() {
      try {
        var res = await fetch('/api/wallet-items');
        if (res.ok) {
          var items = await res.json();
          WALLET_ITEMS = items.map(function(item) {
            return {
              id: item.id,
              name: item.name,
              tagline: item.tagline || '',
              points: item.points,
              cap: item.cap || null,
              available_now: item.available_now || false,
              drive_url: item.drive_url || null,
              icon: ITEM_ICONS[item.id] || ITEM_ICONS._default
            };
          });
        }
      } catch(e) { console.error('Failed to load wallet items', e); }
    }

    var CONFIRM_COPY = {
      playlist: {
        title: 'Confidence Playlist Unlocked',
        body: 'Your Curated Confidence Playlist is now active. Check your email for your private audio message from Dr. TMac and the Pre-Tee Ritual guide. This is your mindset foundation \u2014 use it before every tee time.',
        cta: null
      },
      priority: {
        title: 'Priority Access Secured',
        body: 'You have locked in early access to future Tee Elite events. You will receive advance notice before public registration opens \u2014 including private registration tiers unavailable to the general list.',
        cta: null
      },
      vault: {
        title: 'Mini Vault Unlocked',
        body: 'Your Influence on the Course Mini Vault is now accessible. Inside: The 9-Hole Networking Flow, Fairway Follow-Up Scripts, Wealth While You Golf Blueprint, Sponsorship Pitch Template, and the Bogey Bounce-Back System. Check your email for access.',
        cta: null
      },
      ray: {
        title: 'Priority Performance Access Confirmed',
        body: 'You have successfully secured Priority Access to the Tee Elite Performance Clinic with Ray.\n\nThis is a 90-minute in-person performance session designed to improve scoring, confidence, and course strategy.\n\nAs a Priority participant, you will receive:\n\u2022 Reserved front-range positioning\n\u2022 Guaranteed live swing observation\n\u2022 Direct feedback during the session\n\nDate and time will be announced soon. Please plan to attend in person if possible. The live session is where the real value happens.\n\nIf you are unable to attend, a recording will be made available inside the Digital Swag Vault.\n\nYou\'re locked in.',
        cta: null
      },
      roundtable: {
        title: 'Executive Roundtable \u2014 Seat Reserved',
        body: 'Your seat at the Executive Roundtable is confirmed. Sunday, May 3 \u00b7 6:00\u20137:30pm. Dr. TMac will add you to the calendar invite and Google will send you a confirmation. This is a small room \u2014 12 women maximum. Expect depth, not volume.',
        cta: null
      },
      sprint: {
        title: 'Strategy Sprint Confirmed',
        body: 'Your 45-minute Strategy Sprint with Dr. TMac is reserved. Use the link below to select your time. Come with one clear challenge \u2014 leave with a path forward.',
        cta: { label: 'Book Your Time Slot', url: 'https://calendar.app.google/U1Fxvr7UtL3YGtW77' }
      }
    };

    async function loadWallet() {
      try {
        await loadWalletItems();
        var res = await fetch('/api/wallet');
        if (!res.ok) { renderWalletFallback(); return; }
        walletData = await res.json();
        renderWallet();
      } catch(e) { renderWalletFallback(); }
    }

    function renderWalletFallback() {
      var grid = document.getElementById('marketplace-grid');
      if (!grid) return;
      grid.innerHTML = WALLET_ITEMS.map(function(item) {
        return renderMarketplaceItem(item, false, false, false, item.cap || null, true, 100);
      }).join('');
    }

    function renderWallet() {
      if (!walletData) return;
      var bal = walletData.points_balance;
      var isActive = walletData.is_active;
      var daysLeft = walletData.days_left;

      document.getElementById('wallet-balance-display').textContent = bal;
      var spent = 100 - bal;
      var spentEl = document.getElementById('wallet-spent-display');
      if (spentEl) {
        if (spent > 0) {
          spentEl.textContent = '(' + spent + ' pts wishlisted)';
          spentEl.style.display = 'inline';
        } else {
          spentEl.style.display = 'none';
        }
      }
      var pct = (bal / 100) * 100;
      document.getElementById('wallet-points-bar').style.width = pct + '%';

      var badge = document.getElementById('wallet-status-badge');
      var expiry = document.getElementById('wallet-expiry-label');
      var notice = document.getElementById('wallet-locked-notice');

      if (isActive) {
        badge.textContent = 'Active';
        badge.style.background = 'rgba(76,175,80,.2)';
        badge.style.color = '#81c784';
        expiry.textContent = daysLeft > 0 ? 'Expires in ' + daysLeft + ' days' : 'Expired';
        if (notice) notice.style.display = 'none';
      } else {
        badge.textContent = 'Unlocks April 18';
        badge.style.background = 'rgba(201,168,108,.15)';
        badge.style.color = 'var(--tmac-gold)';
        expiry.textContent = 'Browse & wishlist below';
        if (notice) notice.style.display = 'block';
      }

      var grid = document.getElementById('marketplace-grid');
      var capacity = {};
      walletData.items.forEach(function(item) {
        capacity[item.id] = { slots_left: item.slots_left, available: item.available, is_redeemed: item.is_redeemed, is_wishlisted: item.is_wishlisted };
      });

      grid.innerHTML = WALLET_ITEMS.map(function(item) {
        var cap = capacity[item.id] || {};
        return renderMarketplaceItem(item, isActive, cap.is_redeemed, cap.is_wishlisted, cap.slots_left !== undefined ? cap.slots_left : (item.cap || null), cap.available !== false, bal);
      }).join('');
    }

    function renderMarketplaceItem(item, isActive, isRedeemed, isWishlisted, slotsLeft, available, balance) {
      if (available === undefined) available = true;
      var isSoldOut = item.cap && !available;
      var canAfford = balance >= item.points;
      var slotsText = slotsLeft !== null && slotsLeft !== undefined ? slotsLeft + ' spot' + (slotsLeft !== 1 ? 's' : '') + ' left' : 'Unlimited';
      var slotsColor = slotsLeft !== null && slotsLeft !== undefined && slotsLeft <= 3 ? '#c62828' : '#aaa';

      // "Available Now" badge
      var availableBadge = item.available_now
        ? '<span style="display:inline-block;background:rgba(76,175,80,.12);color:#2e7d32;border:1px solid rgba(76,175,80,.25);border-radius:999px;font-size:10px;letter-spacing:.1em;text-transform:uppercase;padding:2px 10px;margin-left:8px;vertical-align:middle;">Available Now</span>'
        : '';

      var actionHtml = '';
      if (isRedeemed) {
        var openHtml = (item.available_now && item.drive_url)
          ? ' <a href="' + item.drive_url + '" target="_blank" rel="noopener" style="font-size:11px;letter-spacing:.12em;text-transform:uppercase;color:var(--tmac-bronze);text-decoration:none;margin-left:12px;">Open \u2197</a>'
          : '';
        actionHtml = '<div style="display:flex;align-items:center;">'
          + '<div style="font-size:11px;letter-spacing:.12em;text-transform:uppercase;color:#4caf50;padding:10px 0;font-weight:500;">\u2713 Redeemed</div>'
          + openHtml + '</div>';
      } else if (isSoldOut) {
        actionHtml = '<div style="font-size:11px;letter-spacing:.12em;text-transform:uppercase;color:#ccc;padding:10px 0;">Sold Out</div>';
      } else if (isActive) {
        var btnStyle = canAfford
          ? 'background:linear-gradient(135deg,#C8A84B 0%,#E8D48A 35%,#F0E09A 50%,#D4A84A 70%,#B8922E 100%);color:var(--green);cursor:pointer;border-radius:999px;font-weight:700;'
          : 'background:#ddd;color:#999;cursor:default;border-radius:999px;';
        actionHtml = '<button onclick="redeemItem(\'' + item.id + '\')" style="' + btnStyle + 'border:none;padding:10px 20px;font-size:11px;letter-spacing:.14em;text-transform:uppercase;font-family:inherit;white-space:nowrap;" ' + (canAfford ? '' : 'disabled') + '>Redeem ' + item.points + ' pts</button>';
      } else {
        // Pre-active: wishlist button. If available_now AND wishlisted, also show Open link
        var wlStyle = isWishlisted
          ? 'background:var(--tmac-bronze);color:#fff;border:1px solid var(--tmac-bronze);border-radius:999px;'
          : 'background:#fff;color:var(--tmac-bronze);border:1px solid var(--tmac-bronze);border-radius:999px;';
        var wlOnclick = item.available_now && item.drive_url && !isWishlisted
          ? 'toggleWishlistAndOpen(\'' + item.id + '\',\'' + item.drive_url + '\')'
          : 'toggleWishlist(\'' + item.id + '\')';
        actionHtml = '<div style="display:flex;align-items:center;gap:10px;">'
          + '<button onclick="' + wlOnclick + '" id="wl-btn-' + item.id + '" style="' + wlStyle + 'padding:10px 18px;font-size:11px;letter-spacing:.12em;text-transform:uppercase;cursor:pointer;font-family:inherit;">'
          + (isWishlisted ? '\u2713 Wishlisted' : '+ Wishlist') + '</button>'
          + (item.available_now && item.drive_url && isWishlisted ? '<a href="' + item.drive_url + '" target="_blank" rel="noopener" style="font-size:11px;letter-spacing:.12em;text-transform:uppercase;color:var(--tmac-bronze);text-decoration:none;">Open \u2197</a>' : '')
          + '</div>';
      }

      return '<div class="wallet-item' + (isRedeemed ? ' redeemed' : '') + (isSoldOut ? ' soldout' : '') + '">'
        + '<div style="flex-shrink:0;margin-top:2px;width:28px;height:28px;display:flex;align-items:center;justify-content:center;">' + item.icon + '</div>'
        + '<div style="flex:1;min-width:0;">'
        + '<div style="display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap;margin-bottom:6px;">'
        + '<div style="font-size:15px;font-weight:500;color:var(--charcoal);">' + item.name + availableBadge + '</div>'
        + '<div style="font-size:13px;font-weight:600;color:var(--tmac-bronze);white-space:nowrap;">' + item.points + ' pts</div>'
        + '</div>'
        + '<div style="font-size:12px;color:#888;line-height:1.6;margin-bottom:10px;">' + item.tagline + '</div>'
        + '<div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;">'
        + '<div style="font-size:11px;color:' + slotsColor + ';">' + slotsText + '</div>'
        + actionHtml
        + '</div>'
        + '</div>'
        + '</div>';
    }

    async function toggleWishlist(itemId) {
      try {
        var res = await fetch('/api/wallet', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ action: 'wishlist', item_id: itemId })
        });
        if (res.ok) { await loadWallet(); updateWishlistSummary(); }
      } catch(e) { console.error('Wishlist error', e); }
    }

    async function toggleWishlistAndOpen(itemId, driveUrl) {
      await toggleWishlist(itemId);
      if (driveUrl) window.open(driveUrl, '_blank', 'noopener');
    }
    function updateWishlistSummary() {
      if (!walletData) return;
      var wishlisted = walletData.items.filter(function(i) { return i.is_wishlisted; });
      var summary = document.getElementById('wishlist-summary');
      var summaryItems = document.getElementById('wishlist-summary-items');
      if (!summary || !summaryItems) return;
      if (wishlisted.length === 0) { summary.style.display = 'none'; return; }
      summary.style.display = 'block';
      summaryItems.innerHTML = wishlisted.map(function(wi) {
        var item = WALLET_ITEMS.find(function(i) { return i.id === wi.id; });
        return item ? '<span style="display:inline-block;background:var(--off);border:1px solid var(--line);border-radius:999px;padding:3px 12px;font-size:12px;margin:2px 4px 2px 0;">' + item.name + ' <span style="color:var(--gold);">' + item.points + ' pts</span></span>' : '';
      }).join('');
    }

    async function redeemItem(itemId) {
      if (!walletData || !walletData.is_active) return;
      var item = WALLET_ITEMS.find(function(i) { return i.id === itemId; });
      if (!item) return;
      try {
        var res = await fetch('/api/wallet', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ action: 'redeem', item_id: itemId })
        });
        var data = await res.json();
        if (res.ok && data.success) {
          walletData.points_balance = data.new_balance;
          var wi = walletData.items.find(function(i) { return i.id === itemId; });
          if (wi) { wi.is_redeemed = true; if (wi.slots_left !== null) wi.slots_left = Math.max(0, wi.slots_left - 1); }
          renderWallet();
          showRedemptionConfirm(itemId);
        }
      } catch(e) { console.error('Redeem error', e); }
    }

    function showRedemptionConfirm(itemId) {
      var copy = CONFIRM_COPY[itemId];
      if (!copy) return;
      var bodyHtml = copy.body.split('\n').map(function(line) {
        if (line.startsWith('\u2022')) return '<div style="padding-left:12px;margin:4px 0;">' + line + '</div>';
        return '<p style="margin:0 0 10px;">' + line + '</p>';
      }).join('');
      var ctaHtml = copy.cta
        ? '<a href="' + copy.cta.url + '" target="_blank" style="display:block;text-align:center;background:var(--deep-forest);color:var(--tmac-blush);padding:14px;font-size:11px;letter-spacing:.18em;text-transform:uppercase;text-decoration:none;margin-top:20px;">' + copy.cta.label + ' \u2192</a>'
        : '';
      document.getElementById('redeem-confirm-content').innerHTML =
        '<div style="font-size:10px;letter-spacing:.2em;text-transform:uppercase;color:var(--tmac-bronze);margin-bottom:8px;">Points Redeemed</div>'
        + '<div style="font-family:\'Cormorant Garamond\',serif;font-size:22px;color:var(--charcoal);margin-bottom:16px;">' + copy.title + '</div>'
        + '<div style="font-size:13px;color:#555;line-height:1.8;">' + bodyHtml + '</div>'
        + ctaHtml;
      openModal('redeem-confirm-modal');
    }
    // ══ END SCRAMBLE WALLET ══════════════════════════════════════════

    renderChecklist();
    loadMember();
    checkLive();
    loadVote();
  </script>

</body>
</html>
